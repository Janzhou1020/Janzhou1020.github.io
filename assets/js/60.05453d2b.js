(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{507:function(s,a,e){"use strict";e.r(a);var t=e(7),n=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("zabbix 客户端和服务端相应的服务端口都需要开启")]),s._v(" "),a("p",[a("strong",[s._v("1.更换下载源为阿里源")])]),s._v(" "),a("p",[a("strong",[s._v("2.下载 zabbix 服务端和客户端")])]),s._v(" "),a("p",[s._v("rpm -Uvh https://mirrors.aliyun.com/zabbix/zabbix/5.0/rhel/7/x86_64/zabbix-release-5.0-1.el7.noarch.rpm")]),s._v(" "),a("p",[s._v("sed -i 's/http://repo.zabbix.com/https://mirrors.aliyun.com/zabbix/' /etc/yum.repos.d/zabbix.repo")]),s._v(" "),a("p",[s._v("sed -i '11s/enabled=0/enabled=1/' /etc/yum.repos.d/zabbix.repo")]),s._v(" "),a("p",[s._v("yum install -y zabbix-server-mysql zabbix-agent（根据需要）")]),s._v(" "),a("p",[a("strong",[s._v("3.下载 zabbix 运行环境")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/yum.repos.d/CentOS-SCLo-scl.repo "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n[centos-sclo-rh]\nname=CentOS-7-SCLo-rh\nbaseurl=https://mirrors.aliyun.com/centos/7/sclo/x86_64/rh/\ngpgcheck=1\nenabled=1\ngpgkey=file://etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-SIG-SCLo\nEOF")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("出现未导入公钥时，可以用 --nogpgcheck")]),s._v(" "),a("p",[s._v("yum install scl-utils-build")]),s._v(" "),a("p",[s._v("yum install -y zabbix-web-mysql-scl")]),s._v(" "),a("p",[s._v("yum install -y zabbix-nginx-conf-scl（也可以使用 apache）")]),s._v(" "),a("p",[s._v("yum install -y mariadb-server")]),s._v(" "),a("p",[a("strong",[s._v("3.zabbix 数据库配置")])]),s._v(" "),a("p",[s._v("设置开机启动：systemctl enable mariadb --now")]),s._v(" "),a("p",[s._v("配置数据库：mysql_secure_installation")]),s._v(" "),a("p",[s._v("建立 zabbix 用户和库")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("create database zabbix character set utf8 collate utf8_bin;\ngrant all privileges on zabbix.* to 'zabbix'@'localhost' identified by 'zabbix';\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("zcat 是一个用于处理压缩文件的命令，它的功能类似于 cat 命令，但主要用于直接读取 .gz 格式（gzip 压缩）的文件，它可以将压缩文件解压并将内容输出到标准输出")]),s._v(" "),a("p",[s._v("导入 zabbix 初始数据库模板：zcat /usr/share/doc/zabbix-server-mysql*/create.sql.gz | mysql -uzabbix -p zabbix")]),s._v(" "),a("p",[s._v("为 zabbix 配置数据库：sed -i 's/# DBPassword=/DBPassword=zabbix/' /etc/zabbix/zabbix_server.conf")]),s._v(" "),a("p",[a("strong",[s._v("4.zabbix web 应用配置")])]),s._v(" "),a("p",[s._v("为 zabbix 前端配置 PHP，必须访问 server_name，否则报错 403")]),s._v(" "),a("p",[s._v("server_name 填 ip 即可")]),s._v(" "),a("p",[s._v("一定要修改 example.com 为自己访问的域名")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/#\\        listen\\          80;/\\        listen\\          80;/'")]),s._v("  /etc/opt/rh/rh-nginx116/nginx/conf.d/zabbix.conf\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/#\\        server_name\\     example.com;/\\        server_name\\     www.zzl.com;/'")]),s._v(" /etc/opt/rh/rh-nginx116/nginx/conf.d/zabbix.conf\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/listen.acl_users = apache/listen.acl_users = apache,nginx/'")]),s._v(" /etc/opt/rh/rh-php72/php-fpm.d/zabbix.conf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("修改前端页面访问真实资源目录")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s@\\        root\\         /opt/rh/rh-nginx116/root/usr/share/nginx/html;@\\        root\\         /usr/share/zabbix;@'")]),s._v(" /etc/opt/rh/rh-nginx116/nginx/nginx.conf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("更改时区亚洲上海")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'$iphp_value[date.timezone] = Asia/Shanghai'")]),s._v(" /etc/opt/rh/rh-php72/php-fpm.d/zabbix.conf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("5.启动服务并设置开机自启")])]),s._v(" "),a("p",[s._v("systemctl restart zabbix-server zabbix-agent rh-nginx116-nginx rh-php72-php-fpm")]),s._v(" "),a("p",[s._v("systemctl enable zabbix-server zabbix-agent rh-nginx116-nginx rh-php72-php-fpm")]),s._v(" "),a("p",[a("strong",[s._v("明明是用 yum 下载的客户端，重启服务器后，systemctl 竟然找不到服务名了，此时需要手动配置一下")])]),s._v(" "),a("p",[s._v("sudo systemctl daemon-reload")]),s._v(" "),a("p",[s._v("sudo systemctl enable zabbix-agent2")]),s._v(" "),a("p",[s._v("sudo systemctl start zabbix-agent2")]),s._v(" "),a("p",[s._v("访问403是server_name设置问题")]),s._v(" "),a("p",[s._v("默认登录的账号密码：账号：Admin  密码：zabbix")]),s._v(" "),a("p",[s._v("解决中文乱码：")]),s._v(" "),a("p",[s._v("yum install wqy-microhei-fonts -y")]),s._v(" "),a("p",[s._v("cp /usr/share/fonts/wqy-microhei/wqy-microhei.ttc /usr/share/fonts/dejavu/DejaVuSans.ttf")]),s._v(" "),a("p",[s._v("systemctl restart zabbix-server")]),s._v(" "),a("p",[s._v("刚刚安装的是 zabbix 服务端，接下来安装客户端 agent[2]")]),s._v(" "),a("p",[s._v("客户端：zabbix-agent、zabbix-agent2（go+c，支持多线程）")]),s._v(" "),a("p",[s._v("安装 zabbix-agent2 客户端：")]),s._v(" "),a("p",[s._v("rpm -Uvh https://mirrors.aliyun.com/zabbix/zabbix/5.0/rhel/7/x86_64/zabbix-release-5.0-1.el7.noarch.rpm")]),s._v(" "),a("p",[s._v("或者是")]),s._v(" "),a("p",[s._v("rpm -Uvh https://mirrors.tuna.tsinghua.edu.cn/zabbix/zabbix/5.0/rhel/7/x86_64/zabbix-agent-5.0.13-1.el7.x86_64.rpm")]),s._v(" "),a("p",[s._v("sed -i 's/http://repo.zabbix.com/https://mirrors.aliyun.com/zabbix/' /etc/yum.repos.d/zabbix.repo")]),s._v(" "),a("p",[s._v("sed -i '11s/enabled=0/enabled=1/' /etc/yum.repos.d/zabbix.repo")]),s._v(" "),a("p",[s._v("yum install -y zabbix-agent2")]),s._v(" "),a("p",[s._v("安装好客户端后，需要配置好客户端的目标服务器")]),s._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:"/img/image-20240827204708085.png",alt:"image-20240827204708085"}}),s._v(" "),a("p",[s._v("设置开机自启：systemctl enable zabbix-agent2")]),s._v(" "),a("p",[s._v("启动客户端：systemctl start zabbix-agent2，端口默认 10050")]),s._v(" "),a("p",[s._v("在 zabbix web 中注册客户端")]),s._v(" "),a("p",[s._v("1.配置 --\x3e 主机 --\x3e 创建主机")]),s._v(" "),a("p",[s._v("填写相关信息后点击《添加》")]),s._v(" "),a("p",[s._v("2.注册主机后，给主机添加硬件监控模板《Template OS Linux by Zabbix agent》，可以对主机的 cpu，内存 等信息进行监控")]),s._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:"/img/image-20240821213653671.png",alt:"image-20240821213653671"}}),s._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:"/img/image-20240821213733210.png",alt:"image-20240821213733210"}}),s._v(" "),a("p",[s._v("ZBX：通过 Zabbix Agent 进行深入的服务器和操作系统监控")]),s._v(" "),a("p",[s._v("SNMP：监控网络设备及其他支持 SNMP 的硬件")]),s._v(" "),a("p",[s._v("JMX：用于监控 Java 应用程序的性能和健康状况")]),s._v(" "),a("p",[s._v("IPMI：监控服务器硬件的底层状态，适用于硬件级别的管理和故障排除")])])}),[],!1,null,null,null);a.default=n.exports}}]);