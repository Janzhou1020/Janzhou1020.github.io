(window.webpackJsonp=window.webpackJsonp||[]).push([[109],{558:function(t,s,a){"use strict";a.r(s);var e=a(7),n=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("https://github.com/prometheus/prometheus/releases/download/v2.53.3/prometheus-2.53.3.darwin-arm64.tar.gz")]),t._v(" "),s("img",{staticStyle:{zoom:"80%"},attrs:{src:"/img/image-20241218172425081.png",alt:"image-20241218172425081"}}),t._v(" "),s("ul",[s("li",[t._v("prometheus：这是一个二进制文件，主要用于启动Prometheus的程序，它是我们的核心程序")]),t._v(" "),s("li",[t._v("prometheus.yml：这个是Prometheus的配置文件，主要用于存储一些Prometheus的相关配置")]),t._v(" "),s("li",[t._v("promtool：用于检查Prometheus的配置等操作")])]),t._v(" "),s("p",[t._v("Prometheus是不依赖任何的外部Runtime的，可以直接运行二进制文件")]),t._v(" "),s("p",[t._v("启动 Prometheus 时默认会直接去引用prometheus.yml这个配置文件")]),t._v(" "),s("p",[s("strong",[t._v("通过 Docker 安装和启动 Prometheus")])]),t._v(" "),s("p",[t._v("前提：安装 Docker 和 docker-composer")]),t._v(" "),s("p",[t._v("通过 docker-composer 安装 Prometheus（git clone 的方式）")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("mkdir /data/\ncd /data/\ngit clone https://gitee.com/linge365/docker-prometheus.git\ncd docker-prometheus\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),t._v(" "),s("img",{staticStyle:{zoom:"80%"},attrs:{src:"/img/image-20241223122814242.png",alt:"image-20241223122814242"}}),t._v(" "),s("p",[t._v("docker-compose up -d")]),t._v(" "),s("img",{staticStyle:{zoom:"80%"},attrs:{src:"/img/image-20241223132645273.png",alt:"image-20241223132645273"}}),t._v(" "),s("img",{staticStyle:{zoom:"80%"},attrs:{src:"/img/image-20241223132702084.png",alt:"image-20241223132702084"}}),t._v(" "),s("p",[t._v("web 访问地址")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("应用")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("访问地址")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("prometheus")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("http://10.0.0.21:9090")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("grafana")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("http://10.0.0.21:3000")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("altermanager")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("http://10.0.0.21:9093")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("node-exporter")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("http://10.0.0.21:9100/metrics")])])])]),t._v(" "),s("img",{staticStyle:{zoom:"80%"},attrs:{src:"/img/image-20241223133458835.png",alt:"image-20241223133458835"}}),t._v(" "),s("img",{staticStyle:{zoom:"80%"},attrs:{src:"/img/image-20241223133526011.png",alt:"image-20241223133526011"}}),t._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 1. Global Configuration（全局配置）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("global")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("scrape_interval")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 15s              "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 默认抓取间隔，单位秒，决定 Prometheus 拉取目标的频率")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("evaluation_interval")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 15s          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 告警规则评估间隔")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("scrape_timeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 10s              "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 每次抓取的超时时间，单位秒")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("external_labels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                 "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 添加全局标签，适用于所有指标")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("monitor")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'example-monitor'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 2. Scrape Configuration（抓取配置）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("scrape_configs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 2.1. 监控 Node Exporter（主机资源监控）")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("job_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'node'")]),t._v("               "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 任务名称，用于标识任务")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("scrape_interval")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 30s           "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 该任务的抓取间隔")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("static_configs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("targets")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost:9100'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'192.168.1.100:9100'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Node Exporter 目标地址")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 2.2. 监控应用服务（例如 Web 服务）")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("job_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'web-service'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("scrape_interval")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 15s\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("static_configs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("targets")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'web-server-1:8080'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'web-server-2:8080'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 2.3. 监控 Kubernetes 集群（使用服务发现）")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("job_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'kubernetes-pods'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kubernetes_sd_configs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("api_server")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://kubernetes.default.svc:443'")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("role")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pod\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("relabel_configs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("source_labels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("__meta_kubernetes_pod_label_app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("target_label")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" app\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 2.4. 监控 MySQL 数据库（MySQL Exporter）")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("job_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("scrape_interval")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 30s\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("static_configs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("targets")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql-server:9104'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 3. Alert Configuration（告警配置）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("alerting")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("alertmanagers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("static_configs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("targets")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'alertmanager:9093'")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 告警处理服务器的地址")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 4. Alert Rules Configuration（告警规则配置）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rule_files")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'alert.rules'")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 引入外部规则文件，用于告警规则定义")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 5. Remote Storage Configuration（远程存储配置）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("remote_read")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("url")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://remote-storage.example.com/api/v1/read"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("remote_write")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("url")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://remote-storage.example.com/api/v1/write"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 6. Other Settings（其他设置）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 日志和其他高级配置可以根据需要添加。")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br"),s("span",{staticClass:"line-number"},[t._v("37")]),s("br"),s("span",{staticClass:"line-number"},[t._v("38")]),s("br"),s("span",{staticClass:"line-number"},[t._v("39")]),s("br"),s("span",{staticClass:"line-number"},[t._v("40")]),s("br"),s("span",{staticClass:"line-number"},[t._v("41")]),s("br"),s("span",{staticClass:"line-number"},[t._v("42")]),s("br"),s("span",{staticClass:"line-number"},[t._v("43")]),s("br"),s("span",{staticClass:"line-number"},[t._v("44")]),s("br"),s("span",{staticClass:"line-number"},[t._v("45")]),s("br"),s("span",{staticClass:"line-number"},[t._v("46")]),s("br"),s("span",{staticClass:"line-number"},[t._v("47")]),s("br"),s("span",{staticClass:"line-number"},[t._v("48")]),s("br"),s("span",{staticClass:"line-number"},[t._v("49")]),s("br"),s("span",{staticClass:"line-number"},[t._v("50")]),s("br"),s("span",{staticClass:"line-number"},[t._v("51")]),s("br"),s("span",{staticClass:"line-number"},[t._v("52")]),s("br"),s("span",{staticClass:"line-number"},[t._v("53")]),s("br"),s("span",{staticClass:"line-number"},[t._v("54")]),s("br"),s("span",{staticClass:"line-number"},[t._v("55")]),s("br"),s("span",{staticClass:"line-number"},[t._v("56")]),s("br")])]),s("p",[t._v("各参数详细解释")]),t._v(" "),s("ol",[s("li",[t._v("全局配置（global）\n"),s("ul",[s("li",[t._v("全局配置定义了 Prometheus 的基本行为和指标")]),t._v(" "),s("li",[t._v("scrape_interval：控制 Prometheus 拉取目标数据的频率，通常设置为 15s 或 30s。过短可能带来较大的负载")]),t._v(" "),s("li",[t._v("evaluation_interval：定义告警规则评估的频率。通常与 scrape_interval 保持一致")]),t._v(" "),s("li",[t._v("scrape_timeout：设置每次抓取目标的最大超时时间。设置过短可能会导致抓取失败，过长则会浪费资源")]),t._v(" "),s("li",[t._v("external_labels：全局标签，用于标记 Prometheus 实例或集群环境中的指标。例如，可以设置为 monitor: 'prod-monitor' 用于区分生产环境的 Prometheus 实例")])])]),t._v(" "),s("li",[t._v("抓取配置（scrape_configs）\n"),s("ul",[s("li",[t._v("这是 Prometheus 配置的核心部分，定义了 Prometheus 如何抓取不同目标的数据。每个 scrape_config 包含以下配置")]),t._v(" "),s("li",[t._v("job_name：抓取任务的名称，用于区分不同的抓取任务。例如，node 用于监控主机资源，mysql 用于监控数据库")]),t._v(" "),s("li",[t._v("static_configs 或 kubernetes_sd_configs\n"),s("ul",[s("li",[t._v("static_configs：用于手动指定目标地址（如 IP 和端口）")]),t._v(" "),s("li",[t._v("kubernetes_sd_configs：用于基于 Kubernetes 服务发现自动抓取监控目标")])])]),t._v(" "),s("li",[t._v("targets：指定抓取目标的地址列表。例如，localhost:9100 是 Node Exporter 监听的端口")]),t._v(" "),s("li",[t._v("relabel_configs：标签重命名规则。可以对抓取的指标标签进行重命名、过滤或添加新的标签")])])]),t._v(" "),s("li",[t._v("告警配置（alerting）\n"),s("ul",[s("li",[t._v("alertmanagers：指定 Prometheus 将告警发送到的目标（通常是 Alertmanager 服务）\n"),s("ul",[s("li",[t._v("targets：定义了 Alertmanager 服务的地址，Prometheus 将告警信息通过 HTTP 发送到这些目标")])])])])]),t._v(" "),s("li",[t._v("告警规则配置（rule_files）\n"),s("ul",[s("li",[t._v("告警规则文件定义了 Prometheus 触发告警的条件。你可以在 prometheus.yml 配置中引用一个或多个规则文件")]),t._v(" "),s("li",[t._v("alert.rules：告警规则文件的路径，可以是相对路径或绝对路径。告警规则文件内容包括各种指标的阈值规则")])])]),t._v(" "),s("li",[t._v("远程存储配置（remote_read 和 remote_write）\n"),s("ul",[s("li",[t._v("Prometheus 支持将数据写入远程存储系统（如 Thanos 或 Cortex）以进行长期存储，也可以从远程存储中读取历史数据")]),t._v(" "),s("li",[t._v("remote_read：配置从远程存储读取数据")]),t._v(" "),s("li",[t._v("remote_write：配置将数据写入远程存储")])])]),t._v(" "),s("li",[t._v("根据具体需求，Prometheus 配置文件还可以包含其他配置项，如日志配置、认证配置等")])]),t._v(" "),s("p",[s("strong",[t._v("总结")])]),t._v(" "),s("p",[t._v("整个 Prometheus 配置文件结构是层次化的，包含全局配置、抓取配置、告警配置、规则文件配置、远程存储配置等多个部分。每个部分都可以根据不同的监控需求进行定制")]),t._v(" "),s("p",[t._v("global：定义全局行为，如抓取频率")]),t._v(" "),s("p",[t._v("scrape_configs：定义具体的抓取任务，决定 Prometheus 监控哪些目标")]),t._v(" "),s("p",[t._v("alerting：配置告警系统，通常与 Alertmanager 配合使用")]),t._v(" "),s("p",[t._v("rule_files：定义告警触发条件")]),t._v(" "),s("p",[t._v("remote_read 和 remote_write：设置远程存储与 Prometheus 的集成")]),t._v(" "),s("p",[t._v("启动 Prometheus：./prometheus")]),t._v(" "),s("img",{staticStyle:{zoom:"80%"},attrs:{src:"/img/image-20241218172904524.png",alt:"image-20241218172904524"}})])}),[],!1,null,null,null);s.default=n.exports}}]);