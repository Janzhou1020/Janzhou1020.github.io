(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{496:function(t,s,a){"use strict";a.r(s);var n=a(7),r=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h5",{attrs:{id:"转发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#转发"}},[t._v("#")]),t._v(" 转发")]),t._v(" "),s("p",[t._v("将用户的请求代理到另一个服务器或服务上进行处理，然后将结果返回给用户，通常用于反向代理或负载均衡")]),t._v(" "),s("p",[t._v("主要属性：")]),t._v(" "),s("ul",[s("li",[t._v("proxy_pass：将请求转发到后端服务器")]),t._v(" "),s("li",[t._v("upstream：定义后端服务器池（用于负载均衡）")])]),t._v(" "),s("p",[t._v("这两种方式在 "),s("strong",[t._v("3.常用场景")]),t._v(" 已经介绍了")]),t._v(" "),s("h5",{attrs:{id:"重写"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#重写"}},[t._v("#")]),t._v(" 重写")]),t._v(" "),s("p",[t._v("修改用户请求的 URI 或 URL，而不改变服务器的响应地址")]),t._v(" "),s("p",[t._v("主要属性：")]),t._v(" "),s("ul",[s("li",[t._v("rewrite：重写请求 URI，不会暴露实际资源路径")]),t._v(" "),s("li",[t._v("return：直接返回重写后的地址或状态码")]),t._v(" "),s("li",[t._v("try_files：优雅地尝试多个文件路径或重写后的路径")])]),t._v(" "),s("p",[t._v("例子：")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("# 简单重写路径\nlocation /old-path/ {\n    rewrite ^/old-path/(.*)$ /new-path/$1 permanent;\n}\n# 将 /old-path/anything 重写为 /new-path/anything\n# permanent 表示返回 301 状态码，告诉浏览器这是永久的地址变更\n# 去掉 URL 中的文件扩展名\nrewrite ^/(.*)\\.html$ /$1 break;\n# 请求 /about.html 会重写为 /about\n# 尝试多个文件路径\nlocation / {\n    try_files $uri $uri/ /index.html;\n}\n# 依次尝试：\n# 文件路径 $uri（如 /about.html）。\n# 目录路径 $uri/（如 /about/）。\n# 如果都不存在，重写为 /index.html\n# 重写路径后转发到后端\nlocation /api/v1/ {\n    rewrite ^/api/v1/(.*)$ /v2/$1 break;\n    proxy_pass http://backend_server;\n}\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br")])]),s("table",[s("thead",[s("tr",[s("th",[t._v("特性")]),t._v(" "),s("th",[t._v("转发")]),t._v(" "),s("th",[t._v("重写")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("作用范围")]),t._v(" "),s("td",[t._v("转发请求到另一个服务器或服务")]),t._v(" "),s("td",[t._v("修改请求的 URI 路径")])]),t._v(" "),s("tr",[s("td",[t._v("指令")]),t._v(" "),s("td",[t._v("proxy_pass、upstream")]),t._v(" "),s("td",[t._v("rewrite、try_files、return")])]),t._v(" "),s("tr",[s("td",[t._v("最终目的")]),t._v(" "),s("td",[t._v("后端处理请求并返回响应")]),t._v(" "),s("td",[t._v("可能修改 URI 后仍由 Nginx 本地处理")])]),t._v(" "),s("tr",[s("td",[t._v("使用场景")]),t._v(" "),s("td",[t._v("后端服务分发、负载均衡、反向代理")]),t._v(" "),s("td",[t._v("URL 优化、旧路径迁移、文件路径映射")])]),t._v(" "),s("tr",[s("td",[t._v("影响的层面")]),t._v(" "),s("td",[t._v("改变请求发送的目标地址")]),t._v(" "),s("td",[t._v("改变请求路径，通常在同一服务器内解析")])])])]),t._v(" "),s("h4",{attrs:{id:""}},[s("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")])])])}),[],!1,null,null,null);s.default=r.exports}}]);